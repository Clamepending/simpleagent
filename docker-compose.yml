services:
  adminagent:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: adminagent
    restart: unless-stopped
    environment:
      PORT: "18789"
      ADMINAGENT_LLM_URL: "${ADMINAGENT_LLM_URL:-http://host.docker.internal:11434/v1/chat/completions}"
      ADMINAGENT_MODEL: "${ADMINAGENT_MODEL:-llama3.2}"
      OPENAI_API_KEY: "${OPENAI_API_KEY:-}"
      ANTHROPIC_API_KEY: "${ANTHROPIC_API_KEY:-}"
      GOOGLE_API_KEY: "${GOOGLE_API_KEY:-}"
      ADMINAGENT_LLM_API_KEY: "${ADMINAGENT_LLM_API_KEY:-}"
      ADMINAGENT_SYSTEM_PROMPT: "${ADMINAGENT_SYSTEM_PROMPT:-You are AdminAgent, a concise, practical operations assistant.}"
      ADMINAGENT_FORWARD_ENABLED: "${ADMINAGENT_FORWARD_ENABLED:-0}"
      ADMINAGENT_FORWARD_URL: "${ADMINAGENT_FORWARD_URL:-}"
      ADMINAGENT_FORWARD_TOKEN: "${ADMINAGENT_FORWARD_TOKEN:-}"
      TELEGRAM_BOT_TOKEN: "${TELEGRAM_BOT_TOKEN:-}"
      TELEGRAM_POLL_ENABLED: "${TELEGRAM_POLL_ENABLED:-1}"
      TELEGRAM_POLL_TIMEOUT_S: "${TELEGRAM_POLL_TIMEOUT_S:-25}"
      TELEGRAM_POLL_RETRY_S: "${TELEGRAM_POLL_RETRY_S:-5}"
    ports:
      - "127.0.0.1:18789:18789"
    volumes:
      - /opt/adminagent/data:/data
